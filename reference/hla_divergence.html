<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate HLA divergence for each individual — hla_divergence • hlabud</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate HLA divergence for each individual — hla_divergence"><meta name="description" content="First, we convert each allele name (e.g. A*01:01) to an amino acid sequence.
The divergence is the sum of the distances between each pair of amino acids at each position, divided by the total sequence length.
The amino acid distance matrix we use is the one published by Grantham 1974 (doi:10.1126/science.185.4154.862), based on three physical properties of amino acids (composition, polarity, and molecular volume) that are correlated with an estimate of relative substitution frequency."><meta property="og:description" content="First, we convert each allele name (e.g. A*01:01) to an amino acid sequence.
The divergence is the sum of the distances between each pair of amino acids at each position, divided by the total sequence length.
The amino acid distance matrix we use is the one published by Grantham 1974 (doi:10.1126/science.185.4154.862), based on three physical properties of amino acids (composition, polarity, and molecular volume) that are correlated with an estimate of relative substitution frequency."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@slowkow"><meta name="twitter:site" content="@slowkow"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hlabud</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/examples.html">hlabud usage examples</a></li>
    <li><a class="dropdown-item" href="../articles/numbering.html">Numbering amino acid positions</a></li>
    <li><a class="dropdown-item" href="../articles/visualize-hla-structure.html">Visualize HLA protein structures</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/slowkow/hlabud"><span class="fa fa-github"></span> GitHub</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate HLA divergence for each individual</h1>
      <small class="dont-index">Source: <a href="https://github.com/slowkow/hlabud/blob/main/R/hla_divergence.R" class="external-link"><code>R/hla_divergence.R</code></a></small>
      <div class="d-none name"><code>hla_divergence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>First, we convert each allele name (e.g. <code>A*01:01</code>) to an amino acid sequence.
The divergence is the sum of the distances between each pair of amino acids at each position, divided by the total sequence length.
The amino acid distance matrix we use is the one published by Grantham 1974 (doi:10.1126/science.185.4154.862), based on three physical properties of amino acids (composition, polarity, and molecular volume) that are correlated with an estimate of relative substitution frequency.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hla_divergence</span><span class="op">(</span></span>
<span>  alleles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A*01:01,A*02:01"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"grantham"</span>,</span>
<span>  release <span class="op">=</span> <span class="st">"latest"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-alleles">alleles<a class="anchor" aria-label="anchor" href="#arg-alleles"></a></dt>
<dd><p>A character vector of comma-delimited alleles for each individual. We usually expect two alleles per individual, but it is possible to have more (or fewer) copies due to copy number alterations. This function still works when each individual has a different number of alleles.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A pairwise amino acid matrix, or a method name: <code>"grantham"</code> or <code>"uniform"</code> to indicate which pairwise amino acid distance matrix to use. If you choose to pass a matrix, then it should be a 20x20 symmetric matrix with zeros on the diagonal, and the rownames and colnames should be the one-letter amino acid codes <code>A R N D C Q E G H I L K M F P S T W Y V</code>.</p></dd>


<dt id="arg-release">release<a class="anchor" aria-label="anchor" href="#arg-release"></a></dt>
<dd><p>Default is "latest". Should be a release name like "3.51.0".</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If TRUE, print messages along the way.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe with divergence for each individual.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The code in this function is a translation of the <a href="https://sourceforge.net/projects/granthamdist" class="external-link">original Perl code</a> by <a href="https://orcid.org/0000-0002-7203-0044" class="external-link">Tobias Lenz</a>, which was published in Pierini &amp; Lenz 2018 MolBiolEvol (https://doi.org/10.1093/molbev/msy116).</p>
<p>When comparing two amino acid sequences, only characters that are one of the 20 amino acids are considered in the divergence calculation, so gaps (and any other characters) do not count.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="hla_releases.html">hla_releases()</a></code> to get a complete list of all release names.</p>
<p><code><a href="amino_distance_matrix.html">amino_distance_matrix()</a></code> to get a amino acid distance matrix that you can use with <code>hla_divergence()</code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">my_genos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A*23:01:12,A*24:550"</span>, <span class="st">"A*25:12N,A*11:27"</span>,</span></span>
<span class="r-in"><span>              <span class="st">"A*24:381,A*33:85"</span>, <span class="st">"A*01:01:,A*01:01,A*02:01"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hla_divergence</span><span class="op">(</span><span class="va">my_genos</span>, method <span class="op">=</span> <span class="st">"grantham"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      A*23:01:12,A*24:550         A*25:12N,A*11:27         A*24:381,A*33:85 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.511811                 3.464567                 5.094488 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A*01:01:,A*01:01,A*02:01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 3.987752 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This is equivalent</span></span></span>
<span class="r-in"><span><span class="fu">hla_divergence</span><span class="op">(</span><span class="va">my_genos</span>, method <span class="op">=</span> <span class="fu"><a href="amino_distance_matrix.html">amino_distance_matrix</a></span><span class="op">(</span><span class="st">"grantham"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      A*23:01:12,A*24:550         A*25:12N,A*11:27         A*24:381,A*33:85 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 0.511811                 3.464567                 5.094488 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A*01:01:,A*01:01,A*02:01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 3.987752 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kamil Slowikowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

