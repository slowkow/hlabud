% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hlabud.R
\name{hla_alignments}
\alias{hla_alignments}
\title{Get sequence alignments from IMGTHLA}
\usage{
hla_alignments(
  gene = "DRB1",
  type = "prot",
  release = "latest",
  verbose = FALSE
)
}
\arguments{
\item{gene}{The name of a gene like "DRB1"}

\item{type}{The type of sequence, one of "prot", "nuc", "gen"}

\item{release}{Default is "latest". Should be a release name like "3.51.0".}

\item{verbose}{If TRUE, print messages along the way.}
}
\value{
A list with a dataframe called \code{sequences} and two matrices \code{alleles} and \code{onehot}.

The dataframe has two columns:
\itemize{
\item \code{allele}: the name of the allele, e.g., \code{DQB*01:01}
\item \code{seq}: the amino acid sequence
}

The matrix \code{alleles} has one row for each allele, and one column for each position, with the values representing the residues at each position in each allele.
The matrix \code{onehot} has a one-hot encoding of the variants that distinguish the alleles, with one row for each allele and one column for each amino acid at each position.
}
\description{
Here are the conventions used for alignments (\href{https://www.ebi.ac.uk/ipd/imgt/hla/alignment/help/}{EBI IMGT-HLA help page}):
\itemize{
\item The entry for each allele is displayed in respect to the reference sequences.
\item Where identity to the reference sequence is present the base will be displayed as a hyphen (-).
\item Non-identity to the reference sequence is shown by displaying the appropriate base at that position.
\item Where an insertion or deletion has occurred this will be represented by a period (.).
\item If the sequence is unknown at any point in the alignment, this will be represented by an asterisk (*).
\item In protein alignments for null alleles, the 'Stop' codons will be represented by a hash (X).
\item In protein alignments, sequence following the termination codon, will not be marked and will appear blank.
\item These conventions are used for both nucleotide and protein alignments.
}
}
\examples{
\donttest{
a <- hla_alignments("DRB1")
head(a$sequences)
a$alleles[1:6,1:6]
a$onehot[1:6,1:6]
}
}
\seealso{
\code{\link[=hla_releases]{hla_releases()}} to get a complete list of all release names.
}
